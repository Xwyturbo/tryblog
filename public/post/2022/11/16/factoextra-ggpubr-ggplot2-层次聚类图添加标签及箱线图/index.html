<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>factoextra&#43;ggpubr&#43;ggplot2-层次聚类图添加标签及箱线图 - My Website</title>
    <meta property="og:title" content="factoextra&#43;ggpubr&#43;ggplot2-层次聚类图添加标签及箱线图 - My Website">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
    

    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="post">
    <header class="masthead">
      <h1><a href="/">My Website</a></h1>

<p class="tagline">小徐同学参考了谢益辉大神的blog，也尝试记录自己的生活</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" hidden/>
  <label id="menu-label" for="menu-check" class="unselectable" hidden>
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">Home</a></li>
  
  <li><a href="/about/">About</a></li>
  
  <li><a href="/categories/">Categories</a></li>
  
  <li><a href="/tags/">Tags</a></li>
  
  <li><a href="/index.xml">Subscribe</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>factoextra&#43;ggpubr&#43;ggplot2-层次聚类图添加标签及箱线图</h1>

<h3>Xwyturbo
  /  2022-11-16</h3>
<hr>


      </header>





<h1 id="1数据的预处理">1.数据的预处理</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(readxl)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(readxl)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(tidyverse)
</span></span></code></pre></div><pre tabindex="0"><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.5 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
## ✔ readr   2.1.3      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(bruceR)
</span></span></code></pre></div><pre tabindex="0"><code>## 
## bruceR (version 0.8.9)
## BRoadly Useful Convenient and Efficient R functions
## 
## Packages also loaded:
## √ dplyr     	√ emmeans     	√ ggplot2
## √ tidyr     	√ effectsize  	√ ggtext
## √ stringr   	√ performance 	√ cowplot
## √ forcats   	√ lmerTest    	√ see
## √ data.table
## 
## Main functions of `bruceR`:
## cc()          	Describe() 	TTEST()
## add()         	Freq()     	MANOVA()
## .mean()       	Corr()     	EMMEANS()
## set.wd()      	Alpha()    	PROCESS()
## import()      	EFA()      	model_summary()
## print_table() 	CFA()      	lavaan_summary()
## 
## https://psychbruce.github.io/bruceR/
## 
## These R packages are dependencies of `bruceR` but not installed:
## vars, phia, BayesFactor, GPArotation
## ***** Please Install All Dependencies *****
## install.packages(&#34;bruceR&#34;, dep=TRUE)
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(writexl)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggpubr)
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Attaching package: &#39;ggpubr&#39;
## 
## The following object is masked from &#39;package:cowplot&#39;:
## 
##     get_legend
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(plotly)
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Attaching package: &#39;plotly&#39;
## 
## The following object is masked from &#39;package:bruceR&#39;:
## 
##     export
## 
## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot
## 
## The following object is masked from &#39;package:stats&#39;:
## 
##     filter
## 
## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  sui_de_initial <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_xlsx</span>(<span style="color:#e6db74">&#34;D:/wenyu/Rrojects/sui_de/sui_de_1107/sui_de_initial.xlsx&#34;</span>)
</span></span><span style="display:flex;"><span>  sd_data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_xlsx</span>(<span style="color:#e6db74">&#34;D:/wenyu/Rrojects/sui_de/sui_de_1107/14种土地利用亚类面积.xlsx&#34;</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#  计算每个村庄每种地类的占村庄全部用地的比重。</span>
</span></span><span style="display:flex;"><span>  sd1 <span style="color:#f92672">&lt;-</span> sd_data<span style="color:#f92672">/</span><span style="color:#a6e22e">rowSums</span>(sd_data)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#  计算县域范围内每种地类占全部用地的比重</span>
</span></span><span style="display:flex;"><span>  sd2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">colSums</span>(sd_data)<span style="color:#f92672">/</span><span style="color:#a6e22e">sum</span>(sd_data)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#  按照14个亚类计算土地利用强度。</span>
</span></span><span style="display:flex;"><span>  sd_data  <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as_tibble</span>(sd_data)
</span></span><span style="display:flex;"><span>  sd_dataset <span style="color:#f92672">&lt;-</span> sd_data <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(lq1 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>科教文卫用地<span style="color:#f92672">/</span>sd2[1],
</span></span><span style="display:flex;"><span>           lq2 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>交通运输用地<span style="color:#f92672">/</span>sd2[2],
</span></span><span style="display:flex;"><span>           lq3 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>林地<span style="color:#f92672">/</span>sd2[3],
</span></span><span style="display:flex;"><span>           lq4 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>园地<span style="color:#f92672">/</span>sd2[4],
</span></span><span style="display:flex;"><span>           lq5 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>水域及水利设施<span style="color:#f92672">/</span>sd2[5],
</span></span><span style="display:flex;"><span>           lq6 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>旱地<span style="color:#f92672">/</span>sd2[6],
</span></span><span style="display:flex;"><span>           lq7 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>草地<span style="color:#f92672">/</span>sd2[7],
</span></span><span style="display:flex;"><span>           lq8 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>水浇地<span style="color:#f92672">/</span>sd2[8],
</span></span><span style="display:flex;"><span>           lq9 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>设施农用地<span style="color:#f92672">/</span>sd2[9],
</span></span><span style="display:flex;"><span>           lq10 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>矿业用地<span style="color:#f92672">/</span>sd2[10],
</span></span><span style="display:flex;"><span>           lq11 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>公共服务用地<span style="color:#f92672">/</span>sd2[11],
</span></span><span style="display:flex;"><span>           lq12 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>商服用地 <span style="color:#f92672">/</span>sd2[12],
</span></span><span style="display:flex;"><span>           lq13 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>工业用地<span style="color:#f92672">/</span>sd2[13],
</span></span><span style="display:flex;"><span>           lq14 <span style="color:#f92672">=</span> sd1<span style="color:#f92672">$</span>物流仓储用地<span style="color:#f92672">/</span>sd2[14])
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># library(writexl)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># write_xlsx(sd_dataset,&#34;sd_dataset.xlsx&#34;)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(readxl)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(readxl)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(tidyverse)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(bruceR)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(writexl)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggpubr)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(plotly)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  sd_mianji <span style="color:#f92672">&lt;-</span> sd_dataset[,<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span>]
</span></span><span style="display:flex;"><span>  sd_mianji <span style="color:#f92672">&lt;-</span> sd_mianji <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(村庄 <span style="color:#f92672">=</span> sui_de_initial<span style="color:#f92672">$</span>QSDWMC )
</span></span><span style="display:flex;"><span>  sd_mjlong <span style="color:#f92672">=</span> sd_mianji <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pivot_longer</span>(<span style="color:#f92672">-</span>村庄, names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;地类&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;面积/公亩&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">str</span>(sd_mjlong)
</span></span></code></pre></div><pre tabindex="0"><code>## tibble [9,310 × 3] (S3: tbl_df/tbl/data.frame)
##  $ 村庄     : chr [1:9310] &#34;踊跃&#34; &#34;踊跃&#34; &#34;踊跃&#34; &#34;踊跃&#34; ...
##  $ 地类     : chr [1:9310] &#34;科教文卫用地&#34; &#34;交通运输用地&#34; &#34;林地&#34; &#34;园地&#34; ...
##  $ 面积/公亩: num [1:9310] 0 0 11010 21856.3 94.9 ...
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  p1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggboxplot</span>(sd_mjlong, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;地类&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;面积/公亩&#34;</span>,fill <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;地类&#34;</span>,
</span></span><span style="display:flex;"><span>                  palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aaas&#34;</span>,<span style="color:#75715e">#杂志Science的配色</span>
</span></span><span style="display:flex;"><span>                  sorting <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;descending&#34;</span>,                   
</span></span><span style="display:flex;"><span>                  rotate <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,                    
</span></span><span style="display:flex;"><span>                  ggtheme <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_bw</span>())<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">theme</span>(legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ylim</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">20001</span>)
</span></span><span style="display:flex;"><span>  p1
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Removed 94 rows containing non-finite values (stat_boxplot).
</code></pre><pre tabindex="0"><code>## Warning: This manual palette can handle a maximum of 10 values. You have
## supplied 14.
</code></pre><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-2-1.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e"># ggexport(p1,filename = &#34;pics/14种地类规模.png&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          width = 4000,height = 2000,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          res = 600)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  sd_quweishang <span style="color:#f92672">&lt;-</span> sd_dataset[,<span style="color:#ae81ff">15</span><span style="color:#f92672">:</span><span style="color:#ae81ff">28</span>]
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">names</span>(sd_quweishang) <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;科教文卫用地&#34;</span>,<span style="color:#e6db74">&#34;交通运输用地&#34;</span>,<span style="color:#e6db74">&#34;林地&#34;</span>,
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">&#34;园地&#34;</span>,<span style="color:#e6db74">&#34;水域及水利设施&#34;</span>,<span style="color:#e6db74">&#34;旱地&#34;</span>,<span style="color:#e6db74">&#34;草地&#34;</span>,
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">&#34;水浇地&#34;</span>,<span style="color:#e6db74">&#34;设施农用地&#34;</span>,<span style="color:#e6db74">&#34;矿业用地&#34;</span>,
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">&#34;公共服务用地&#34;</span>,<span style="color:#e6db74">&#34;商服用地&#34;</span>,
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">&#34;工业用地&#34;</span>,<span style="color:#e6db74">&#34;物流仓储用地&#34;</span>)
</span></span><span style="display:flex;"><span>  sd_quweishang <span style="color:#f92672">&lt;-</span> sd_quweishang <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(村庄 <span style="color:#f92672">=</span> sui_de_initial<span style="color:#f92672">$</span>QSDWMC )
</span></span><span style="display:flex;"><span>  sd_longer <span style="color:#f92672">=</span> sd_quweishang <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pivot_longer</span>(<span style="color:#f92672">-</span>村庄, names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;地类&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;区位商&#34;</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  p2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggboxplot</span>(sd_longer, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;地类&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;区位商&#34;</span>,fill <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;地类&#34;</span>,
</span></span><span style="display:flex;"><span>                 palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aaas&#34;</span>,
</span></span><span style="display:flex;"><span>                 sorting <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;descending&#34;</span>,                   
</span></span><span style="display:flex;"><span>                 rotate <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,                    
</span></span><span style="display:flex;"><span>                 ggtheme <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_bw</span>())<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">theme</span>(legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_hline</span>(yintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,linetype <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>               color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;red&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_y_continuous</span>(breaks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ylim</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which will
## replace the existing scale.
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  p2
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Removed 160 rows containing non-finite values (stat_boxplot).
## This manual palette can handle a maximum of 10 values. You have supplied 14.
</code></pre><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-2-2.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e"># ggexport(p,filename = &#34;pics/绥德县14种地类区位商.png&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          width = 4000,height = 2000,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          res = 600)</span>
</span></span></code></pre></div><h1 id="2层次聚类图美化">2.层次聚类图美化</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggdendro)
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: package &#39;ggdendro&#39; was built under R version 4.2.2
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(factoextra)
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: package &#39;factoextra&#39; was built under R version 4.2.2
</code></pre><pre tabindex="0"><code>## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggpubr)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggsci)
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Attaching package: &#39;ggsci&#39;
</code></pre><pre tabindex="0"><code>## The following objects are masked from &#39;package:see&#39;:
## 
##     scale_color_material, scale_colour_material, scale_fill_material
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(readxl)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(tidyverse)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#  层次聚类，先生成距离矩阵。</span>
</span></span><span style="display:flex;"><span>  d1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">dist</span>(sd_dataset[,<span style="color:#ae81ff">15</span><span style="color:#f92672">:</span><span style="color:#ae81ff">28</span>],<span style="color:#e6db74">&#34;canberra&#34;</span>)
</span></span><span style="display:flex;"><span>  hc7 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">hclust</span>(d1,<span style="color:#e6db74">&#34;ward.D2&#34;</span>)
</span></span><span style="display:flex;"><span>  tree <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.dendrogram</span>(hc7)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  c2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cutree</span>(hc7,<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">table</span>(c2)
</span></span></code></pre></div><pre tabindex="0"><code>## c2
##   1   2 
## 244 421
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">plot</span>(<span style="color:#a6e22e">cut</span>(tree, h<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>)<span style="color:#f92672">$</span>upper, horiz<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rect.hclust</span>(hc7,<span style="color:#ae81ff">2</span>)
</span></span></code></pre></div><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-3-1.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  c3 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cutree</span>(hc7,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">table</span>(c3)
</span></span></code></pre></div><pre tabindex="0"><code>## c3
##   1   2   3 
## 244 149 272
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">plot</span>(<span style="color:#a6e22e">cut</span>(tree, h<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>)<span style="color:#f92672">$</span>upper, horiz<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rect.hclust</span>(hc7,<span style="color:#ae81ff">3</span>)
</span></span></code></pre></div><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-3-2.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  c4 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cutree</span>(hc7,<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">table</span>(c4)
</span></span></code></pre></div><pre tabindex="0"><code>## c4
##   1   2   3   4 
## 244 149 193  79
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">plot</span>(<span style="color:#a6e22e">cut</span>(tree, h<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>)<span style="color:#f92672">$</span>upper, horiz<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rect.hclust</span>(hc7,<span style="color:#ae81ff">4</span>)
</span></span></code></pre></div><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-3-3.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  c5 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cutree</span>(hc7,<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">table</span>(c5)
</span></span></code></pre></div><pre tabindex="0"><code>## c5
##   1   2   3   4   5 
## 108 149 136 193  79
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">plot</span>(<span style="color:#a6e22e">cut</span>(tree, h<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>)<span style="color:#f92672">$</span>upper, horiz<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rect.hclust</span>(hc7,<span style="color:#ae81ff">5</span>)
</span></span></code></pre></div><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-3-4.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e">#vignette(&#34;ggsci&#34;)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pal_aaas</span>(palette <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;default&#34;</span>), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)(<span style="color:#ae81ff">5</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] &#34;#3B4992FF&#34; &#34;#EE0000FF&#34; &#34;#008B45FF&#34; &#34;#631879FF&#34; &#34;#008280FF&#34;
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">pal_npg</span>(palette <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;nrc&#34;</span>), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)(<span style="color:#ae81ff">8</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] &#34;#E64B35FF&#34; &#34;#4DBBD5FF&#34; &#34;#00A087FF&#34; &#34;#3C5488FF&#34; &#34;#F39B7FFF&#34; &#34;#8491B4FF&#34;
## [7] &#34;#91D1C2FF&#34; &#34;#DC0000FF&#34;
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  p52 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fviz_dend</span>(hc7,k <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>                   xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄&#34;</span>,
</span></span><span style="display:flex;"><span>                   ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Height&#34;</span>,
</span></span><span style="display:flex;"><span>                   main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>                   rect <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,
</span></span><span style="display:flex;"><span>                   k_colors <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;#3B4992FF&#34;</span>,<span style="color:#e6db74">&#34;#EE0000FF&#34;</span>),
</span></span><span style="display:flex;"><span>                   ggtheme <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_bw</span>())<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:244&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3B4992FF&#34;</span>,size<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">400</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">48</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:421&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#EE0000FF&#34;</span>,size<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>) 
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## &#34;none&#34;)` instead.
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  p52
</span></span></code></pre></div><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-3-5.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e"># ggexport(p52,filename = &#34;pics/聚类谱系图2.png&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          width = 3400,height = 3000,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          res = 600)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  p53 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fviz_dend</span>(hc7,k <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>                   xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄&#34;</span>,
</span></span><span style="display:flex;"><span>                   ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Height&#34;</span>,
</span></span><span style="display:flex;"><span>                   main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>                   rect <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,
</span></span><span style="display:flex;"><span>                   k_colors <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;#3B4992FF&#34;</span>,<span style="color:#e6db74">&#34;#EE0000FF&#34;</span>,<span style="color:#e6db74">&#34;#008B45FF&#34;</span>),
</span></span><span style="display:flex;"><span>                   ggtheme <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_bw</span>())<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">110</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:244&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3B4992FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">300</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:149&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#EE0000FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:272&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#008B45FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## &#34;none&#34;)` instead.
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  p53
</span></span></code></pre></div><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-3-6.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e"># ggexport(p53,filename = &#34;pics/聚类谱系图3.png&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          width = 3400,height = 3000,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          res = 600)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  p54 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fviz_dend</span>(hc7,k <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>                   xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄&#34;</span>,
</span></span><span style="display:flex;"><span>                   ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Height&#34;</span>,
</span></span><span style="display:flex;"><span>                   main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>                   rect <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,
</span></span><span style="display:flex;"><span>                   k_colors <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;#3B4992FF&#34;</span>,<span style="color:#e6db74">&#34;#EE0000FF&#34;</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#e6db74">&#34;#008B45FF&#34;</span>,<span style="color:#e6db74">&#34;#631879FF&#34;</span>),
</span></span><span style="display:flex;"><span>                   ggtheme <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_bw</span>())<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">110</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:244&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3B4992FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">310</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:149&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#EE0000FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">430</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:79&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#008B45FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">550</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">28</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:193&#34;</span>,colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#631879FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## &#34;none&#34;)` instead.
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">table</span>(c3)
</span></span></code></pre></div><pre tabindex="0"><code>## c3
##   1   2   3 
## 244 149 272
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">table</span>(c5)  
</span></span></code></pre></div><pre tabindex="0"><code>## c5
##   1   2   3   4   5 
## 108 149 136 193  79
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  p54
</span></span></code></pre></div><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-3-7.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e"># ggexport(p54,filename = &#34;pics/聚类谱系图4.png&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          width = 3400,height = 3000,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          res = 600)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  p55 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fviz_dend</span>(hc7,k <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>                   xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄&#34;</span>,
</span></span><span style="display:flex;"><span>                   ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Height&#34;</span>,
</span></span><span style="display:flex;"><span>                   main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>                   rect <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,
</span></span><span style="display:flex;"><span>                   k_colors <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;#3B4992FF&#34;</span>,<span style="color:#e6db74">&#34;#F39B7FFF&#34;</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#e6db74">&#34;#EE0000FF&#34;</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#e6db74">&#34;#008B45FF&#34;</span>,<span style="color:#e6db74">&#34;#631879FF&#34;</span>),
</span></span><span style="display:flex;"><span>                   ggtheme <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_bw</span>())<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:136&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3B4992FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">190</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">28</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:108&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#F39B7FFF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">310</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:149&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#EE0000FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">430</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:79&#34;</span>,colour<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#008B45FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotate</span>(<span style="color:#e6db74">&#34;text&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">550</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">28</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;村庄数:193&#34;</span>,colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#631879FF&#34;</span>,
</span></span><span style="display:flex;"><span>             size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## &#34;none&#34;)` instead.
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  p55
</span></span></code></pre></div><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-3-8.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e"># ggexport(p55,filename = &#34;pics/聚类谱系图5.png&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          width = 3400,height = 3000,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          res = 600)</span>
</span></span></code></pre></div><h1 id="3箱线图">3.箱线图</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggdendro)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(factoextra)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggpubr)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(ggsci)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(readxl)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(tidyverse)
</span></span><span style="display:flex;"><span>  sd_dataset_hclust <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_xlsx</span>(<span style="color:#e6db74">&#34;D:/wenyu/Rrojects/sui_de/sui_de_1107/sd_hclust.xlsx&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">table</span>(sd_dataset_hclust<span style="color:#f92672">$</span>结果_5)
</span></span></code></pre></div><pre tabindex="0"><code>## 
##   1   2   3   4   5 
## 108 149 136 193  79
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  sdhc1 <span style="color:#f92672">&lt;-</span>  sd_dataset_hclust <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">filter</span>(结果_5 <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>) 
</span></span><span style="display:flex;"><span>  sdhc1_mianji <span style="color:#f92672">&lt;-</span> sdhc1[,<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">35</span>)]
</span></span><span style="display:flex;"><span>  sdhc1_quweishang <span style="color:#f92672">&lt;-</span> sdhc1[,<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">15</span><span style="color:#f92672">:</span><span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">35</span>)]
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">str</span>(sdhc1_quweishang)
</span></span></code></pre></div><pre tabindex="0"><code>## tibble [136 × 15] (S3: tbl_df/tbl/data.frame)
##  $ lq1 : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ lq2 : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ lq3 : num [1:136] 0.868 1.162 1.039 1.06 1.481 ...
##  $ lq4 : num [1:136] 0.503 0.842 0.539 0.421 0.502 ...
##  $ lq5 : num [1:136] 0.3743 0.0823 1.2515 0 0.3604 ...
##  $ lq6 : num [1:136] 0.945 1.382 0.953 1.031 0.883 ...
##  $ lq7 : num [1:136] 1.399 0.906 1.284 1.338 1.205 ...
##  $ lq8 : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ lq9 : num [1:136] 0 0 0 0 0 ...
##  $ lq10: num [1:136] 0 0 0 0 0 ...
##  $ lq11: num [1:136] 0 0 0 0 0.543 ...
##  $ lq12: num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ lq13: num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ lq14: num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 村庄: chr [1:136] &#34;张家塔&#34; &#34;周家沟&#34; &#34;东沟&#34; &#34;红旗沟&#34; ...
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">names</span>(sdhc1_quweishang) <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;科教文卫用地&#34;</span>,<span style="color:#e6db74">&#34;交通运输用地&#34;</span>,<span style="color:#e6db74">&#34;林地&#34;</span>,
</span></span><span style="display:flex;"><span>                               <span style="color:#e6db74">&#34;园地&#34;</span>,<span style="color:#e6db74">&#34;水域及水利设施&#34;</span>,<span style="color:#e6db74">&#34;旱地&#34;</span>,<span style="color:#e6db74">&#34;草地&#34;</span>,
</span></span><span style="display:flex;"><span>                               <span style="color:#e6db74">&#34;水浇地&#34;</span>,<span style="color:#e6db74">&#34;设施农用地&#34;</span>,<span style="color:#e6db74">&#34;矿业用地&#34;</span>,
</span></span><span style="display:flex;"><span>                               <span style="color:#e6db74">&#34;公共服务用地&#34;</span>,<span style="color:#e6db74">&#34;商服用地&#34;</span>,
</span></span><span style="display:flex;"><span>                               <span style="color:#e6db74">&#34;工业用地&#34;</span>,<span style="color:#e6db74">&#34;物流仓储用地&#34;</span>,<span style="color:#e6db74">&#34;村庄&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">str</span>(sdhc1_quweishang)
</span></span></code></pre></div><pre tabindex="0"><code>## tibble [136 × 15] (S3: tbl_df/tbl/data.frame)
##  $ 科教文卫用地  : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 交通运输用地  : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 林地          : num [1:136] 0.868 1.162 1.039 1.06 1.481 ...
##  $ 园地          : num [1:136] 0.503 0.842 0.539 0.421 0.502 ...
##  $ 水域及水利设施: num [1:136] 0.3743 0.0823 1.2515 0 0.3604 ...
##  $ 旱地          : num [1:136] 0.945 1.382 0.953 1.031 0.883 ...
##  $ 草地          : num [1:136] 1.399 0.906 1.284 1.338 1.205 ...
##  $ 水浇地        : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 设施农用地    : num [1:136] 0 0 0 0 0 ...
##  $ 矿业用地      : num [1:136] 0 0 0 0 0 ...
##  $ 公共服务用地  : num [1:136] 0 0 0 0 0.543 ...
##  $ 商服用地      : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 工业用地      : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 物流仓储用地  : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 村庄          : chr [1:136] &#34;张家塔&#34; &#34;周家沟&#34; &#34;东沟&#34; &#34;红旗沟&#34; ...
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">str</span>(sdhc1_mianji)
</span></span></code></pre></div><pre tabindex="0"><code>## tibble [136 × 15] (S3: tbl_df/tbl/data.frame)
##  $ 科教文卫用地  : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 交通运输用地  : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 林地          : num [1:136] 3836 3502 2934 2967 6654 ...
##  $ 园地          : num [1:136] 3043 3474 2087 1613 3093 ...
##  $ 水域及水利设施: num [1:136] 152 22.8 325 0 148.9 ...
##  $ 旱地          : num [1:136] 5815 5803 3750 4021 5529 ...
##  $ 草地          : num [1:136] 16783 7410 9850 10168 14706 ...
##  $ 水浇地        : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 设施农用地    : num [1:136] 0 0 0 0 0 ...
##  $ 矿业用地      : num [1:136] 0 0 0 0 0 ...
##  $ 公共服务用地  : num [1:136] 0 0 0 0 8.68 ...
##  $ 商服用地      : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 工业用地      : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 物流仓储用地  : num [1:136] 0 0 0 0 0 0 0 0 0 0 ...
##  $ 村庄          : chr [1:136] &#34;张家塔&#34; &#34;周家沟&#34; &#34;东沟&#34; &#34;红旗沟&#34; ...
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e">## 先把各地类面积的宽表转成长表</span>
</span></span><span style="display:flex;"><span>  sdhc1_mjlong <span style="color:#f92672">=</span> sdhc1_mianji <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pivot_longer</span>(<span style="color:#f92672">-</span>村庄, names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;地类&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;面积/公亩&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">str</span>(sdhc1_mjlong)
</span></span></code></pre></div><pre tabindex="0"><code>## tibble [1,904 × 3] (S3: tbl_df/tbl/data.frame)
##  $ 村庄     : chr [1:1904] &#34;张家塔&#34; &#34;张家塔&#34; &#34;张家塔&#34; &#34;张家塔&#34; ...
##  $ 地类     : chr [1:1904] &#34;科教文卫用地&#34; &#34;交通运输用地&#34; &#34;林地&#34; &#34;园地&#34; ...
##  $ 面积/公亩: num [1:1904] 0 0 3836 3043 152 ...
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e">## 基于各地类面积长表，绘制箱线图</span>
</span></span><span style="display:flex;"><span>  p1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggboxplot</span>(sdhc1_mjlong, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;地类&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;面积/公亩&#34;</span>,fill <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;地类&#34;</span>,
</span></span><span style="display:flex;"><span>                  palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aaas&#34;</span>,<span style="color:#75715e">#杂志Science的配色</span>
</span></span><span style="display:flex;"><span>                  sorting <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;descending&#34;</span>,                   
</span></span><span style="display:flex;"><span>                  rotate <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,                    
</span></span><span style="display:flex;"><span>                  ggtheme <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_bw</span>())<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">theme</span>(legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ylim</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">20001</span>)
</span></span><span style="display:flex;"><span>  p1
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Removed 8 rows containing non-finite values (stat_boxplot).
</code></pre><pre tabindex="0"><code>## Warning: This manual palette can handle a maximum of 10 values. You have
## supplied 14.
</code></pre><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-4-1.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e"># ggexport(p1,filename = &#34;pics/聚类5对应的136个村庄地类面积.png&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          width = 4000,height = 2000,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          res = 600)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">## 先把各地类区位商的宽表转成长表</span>
</span></span><span style="display:flex;"><span>  sdhc1_qwsl<span style="color:#f92672">=</span> sdhc1_quweishang <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pivot_longer</span>(<span style="color:#f92672">-</span>村庄, names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;地类&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;区位商&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">str</span>(sdhc1_qwsl)
</span></span></code></pre></div><pre tabindex="0"><code>## tibble [1,904 × 3] (S3: tbl_df/tbl/data.frame)
##  $ 村庄  : chr [1:1904] &#34;张家塔&#34; &#34;张家塔&#34; &#34;张家塔&#34; &#34;张家塔&#34; ...
##  $ 地类  : chr [1:1904] &#34;科教文卫用地&#34; &#34;交通运输用地&#34; &#34;林地&#34; &#34;园地&#34; ...
##  $ 区位商: num [1:1904] 0 0 0.868 0.503 0.374 ...
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e">## 基于各地类面积长表，绘制箱线图</span>
</span></span><span style="display:flex;"><span>  p1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggboxplot</span>(sdhc1_qwsl, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;地类&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;区位商&#34;</span>,fill <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;地类&#34;</span>,
</span></span><span style="display:flex;"><span>                  palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aaas&#34;</span>,
</span></span><span style="display:flex;"><span>                  sorting <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;descending&#34;</span>,                   
</span></span><span style="display:flex;"><span>                  rotate <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,                    
</span></span><span style="display:flex;"><span>                  ggtheme <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_bw</span>())<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">theme</span>(legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_hline</span>(yintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,linetype <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>               color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;red&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_y_continuous</span>(breaks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ylim</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which will
## replace the existing scale.
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  p1
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Removed 7 rows containing non-finite values (stat_boxplot).
## This manual palette can handle a maximum of 10 values. You have supplied 14.
</code></pre><img src="factoextra+ggpubr+ggplot2-层次聚类图添加标签及箱线图_files/figure-html/unnamed-chunk-4-2.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#75715e"># ggexport(p1,filename = &#34;pics/聚类5对应的136个村庄地类区位商.png&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          width = 4000,height = 2000,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#          res = 600)</span>
</span></span></code></pre></div>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/post/2022/11/15/factoextra%E5%8C%85%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB%E5%9B%BE%E7%BE%8E%E5%8C%96/">factoextra包–层次聚类图美化</a></span>
  <span class="nav-next"><a href="/post/2022/11/20/voronoitreemap%E5%8C%85-%E7%BB%98%E5%88%B6%E6%B2%83%E7%BD%97%E8%AF%BA%E4%BC%8A%E6%A0%91%E5%9B%BE/">voronoiTreemap包-绘制沃罗诺伊树图</a> &rarr;</span>
</nav>





<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.org/js/center-img.js"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">2022 | <a href="https://github.com/Xwyturbo">Github</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

